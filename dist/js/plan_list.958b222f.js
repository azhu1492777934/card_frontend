(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["plan_list"],{"1d44":function(e,t,a){},2994:function(e,t,a){"use strict";a("68ef"),a("c0c2")},"2bdd":function(e,t,a){"use strict";var i=a("fe7e"),n=a("023d"),s=a("db78");t["a"]=Object(i["a"])({render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.b()},[e._t("default"),e.loading?a("div",{class:e.b("loading")},[e._t("loading",[a("loading",{class:e.b("loading-icon")}),a("span",{class:e.b("loading-text")},[e._v(e._s(e.loadingText||e.$t("loadingTip")))])])],2):e._e(),e.finished&&e.finishedText?a("div",{class:e.b("finished-text")},[e._v("\n    "+e._s(e.finishedText)+"\n  ")]):e._e()],2)},name:"list",model:{prop:"loading"},props:{loading:Boolean,finished:Boolean,loadingText:String,finishedText:String,immediateCheck:{type:Boolean,default:!0},offset:{type:Number,default:300}},mounted:function(){this.scroller=n["a"].getScrollEventTarget(this.$el),this.handler(!0),this.immediateCheck&&this.$nextTick(this.check)},destroyed:function(){this.handler(!1)},activated:function(){this.handler(!0)},deactivated:function(){this.handler(!1)},watch:{loading:function(){this.$nextTick(this.check)},finished:function(){this.$nextTick(this.check)}},methods:{check:function(){if(!this.loading&&!this.finished){var e=this.$el,t=this.scroller,a=n["a"].getVisibleHeight(t);if(a&&"none"!==n["a"].getComputedStyle(e).display&&null!==e.offsetParent){var i=n["a"].getScrollTop(t),s=i+a,c=!1;if(e===t)c=t.scrollHeight-s<this.offset;else{var l=n["a"].getElementTop(e)-n["a"].getElementTop(t)+n["a"].getVisibleHeight(e);c=l-a<this.offset}c&&(this.$emit("input",!0),this.$emit("load"))}}},handler:function(e){this.binded!==e&&(this.binded=e,(e?s["b"]:s["a"])(this.scroller,"scroll",this.check))}}})},"705e":function(e,t,a){"use strict";a.r(t);var i,n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"plan-wrap"},[a("div",{ref:"vanSwiperWwrap",staticClass:"van-swipe-wrap"},e._l(e.plan_list,function(t,i){return a("div",{key:i},["0"===i?a("div",{staticClass:"plan-type-name"},[e._v(e._s(e.plan_type_name[0]))]):e._e(),"1"===i?a("div",{staticClass:"plan-type-name"},[e._v(e._s(e.plan_type_name[1]))]):e._e(),"100"===i&&e.plan_list[100]?a("div",{staticClass:"plan-type-name"},[e._v(e._s("加油包"))]):e._e(),"5"===i?a("div",{staticClass:"plan-type-name"},[e._v(e._s(e.plan_type_name[5]))]):e._e(),"6"===i?a("div",{staticClass:"plan-type-name"},[e._v(e._s(e.plan_type_name[6]))]):e._e(),a("div",{staticClass:"planContent"},[e._l(t,function(t,n){return a("div",{key:n,class:{activedPlan:t.id==e.choose_plan_index,"plan-sell-done":"False"!=t.surplus_times&&t.surplus_times<=0},on:{click:function(a){e.choosePlanClick(t.id,i)}}},[a("el-popover",{attrs:{placement:"bottom",content:t.describe?t.describe:t.remark?t.remark:"",value:t.id==e.choose_plan_index&&e.firstStatus}},[a("div",{staticClass:"centerBox",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"contentWord1"},[e._v(e._s(t.name))]),a("div",{staticClass:"contentWord2"}),a("div",{staticClass:"contentWord3"},[a("p",[e._v("￥"+e._s(t.price))]),a("del",[e._v("￥"+e._s(t.market_price))])]),a("p",{staticClass:"plan-name",class:{"plan-icon-recommend":t.is_recommend}},[t.is_recommend?a("span",{staticClass:"iconfont icon-recommend"}):e._e()]),t.image_url?a("div",{staticClass:"gift"},[a("img",{attrs:{src:t.image_url,alt:""}})]):e._e()])])],1)}),"100"===i&&e.plan_list[100]?a("div",{staticClass:"warning-wrapper"},[a("p",[e._v("加油包暂不支持退款请慎重选择")]),a("p",[e._v("加油包有效期和指定套餐有效期相同")]),a("p",[e._v("月套餐充值加油包仅当月有效")]),a("p",[e._v("加油包需充值到指定套餐中方可使用")])]):e._e()],2)])})),a("div",{ref:"refPlanButton",staticClass:"btn-recharge-wrap",class:{noDataHide:e.load_plan_list}},[a("button",{on:{click:e.recharge}},[e._v(e._s(e.recharge_btn_text))]),a("a",{on:{click:function(t){e.toCard()}}},[e._v("卡券兑换")])]),a("van-popup",{attrs:{"close-on-click-overlay":!1},model:{value:e.load_plan_list,callback:function(t){e.load_plan_list=t},expression:"load_plan_list"}},[a("p",{staticClass:"showTip"},[e._v(e._s(e.load_plan_msg))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:""==e.load_plan_msg,expression:"load_plan_msg==''"}],staticClass:"fixed-wrap-loading"},[e._m(0)]),a("van-popup",{attrs:{"close-on-click-overlay":!1},model:{value:e.rechargeShow,callback:function(t){e.rechargeShow=t},expression:"rechargeShow"}},[a("p",{staticClass:"showTip"},[e._v("创建订单中,请等候")])])],1)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"loading-common-center"}},[a("div",{attrs:{id:"loading-common-center-inner"}},[a("div",{staticClass:"loading-object",attrs:{id:"first_object"}}),a("div",{staticClass:"loading-object",attrs:{id:"second_object"}}),a("div",{staticClass:"loading-object",attrs:{id:"third_object"}})])])}],c=(a("9a83"),a("f564")),l=(a("6b54"),a("55dd"),a("a322")),o=(a("e17f"),a("2241")),r=(a("2994"),a("2bdd")),d=(a("8a58"),a("e41f")),p=(a("7f7f"),a("e7e5"),a("d399")),_=a("c93e"),u=(a("cadf"),a("551c"),a("097d"),a("2f62")),h=a("35df"),f=a("db04"),m={name:"home",computed:Object(_["a"])({},Object(u["b"])({authorizedUserInfo:function(e){return e.userInfo.userInfoInner}})),data:function(){return{client_type:Object(h["d"])(),load_plan_list:!1,load_plan_msg:"",recharge_btn_text:"充值",plan_type:[],plan_type_name:{0:"累计套餐",1:"月套餐",2:"加油包",5:"周期性套餐",6:"超量自动续费套餐"},cur_plan_type_index:0,choose_plan_index:0,plan_list:{},hasValidatedPlan:Object(h["j"])("hasValidatedPlan"),rechargeShow:!1,ref_plan_type_index:0,firstStatus:!1,realnameType:Object(h["j"])("realnameType")}},components:(i={},Object(l["a"])(i,p["a"].name,p["a"]),Object(l["a"])(i,d["a"].name,d["a"]),Object(l["a"])(i,r["a"].name,r["a"]),Object(l["a"])(i,o["a"].name,o["a"]),i),created:function(){var e=this;"1"===Object(h["j"])("plan_list_new_card")&&Object(h["m"])({type:4,iccid:Object(h["j"])("check_iccid")});var t=this;Object(f["a"])("/api/v1/app/plan_list",{iccid:Object(h["j"])("check_iccid")}).then(function(a){if(1===a.state){if("{}"===JSON.stringify(a.data)||0===a.data.length)return e.load_plan_list=!0,void(e.load_plan_msg="此卡暂无充值套餐，请联系客服人员及时处理");for(var i in e.load_plan_msg=a.msg,e.load_plan_list=!1,e.plan_list=a.data,e.plan_list){for(var n=[],s=[],c=[],l=0;l<e.plan_list[i].length;l++)!0===e.plan_list[i][l].is_recommend?n.push(e.plan_list[i][l]):s.push(e.plan_list[i][l]);n.sort(e.compare2("price")),s.sort(e.compare2("price")),c=n.concat(s),e.plan_list[i]=c,e.plan_type.push(i)}if(e.hasValidatedPlan){var o=e.plan_list[2]||[];o.length&&(delete e.plan_list[2],e.plan_list[100]=o)}else e.plan_list[2]=null;for(var r in e.$nextTick(function(){var t=document.documentElement.clientHeight||document.body.clientHeight,a=e.$refs.refPlanButton.offsetHeight,i=Object(h["j"])("userHeight")||44;forIphoneHeight=window.screen.availHeight,"iphone"==e.global_variables.device&&(t=forIphoneHeight),"wechat"===e.client_type||e.client_type,e.$refs.vanSwiperWwrap.style.height=t-a-i+"px"}),setTimeout(function(){t.firstStatus=!0},100),a.data)if(a.data[r]||"undefined"===typeof a.data[r]||0===a.data[r])return e.choose_plan_index=a.data[r][0].id,e.ref_plan_type_index=r,e.choose_plan_index}else e.load_plan_list=!0,e.load_plan_msg=a.msg})},mounted:function(){},methods:{choosePlanClick:function(e,t){this.ref_plan_type_index=t,this.choose_plan_index=e,this.recharge_btn_text="2"===t?"选择叠加加油包套餐":"充值"},recharge:function(){for(var e=this,t=null,a=0;a<this.plan_list[this.ref_plan_type_index].length;a++)this.choose_plan_index==this.plan_list[this.ref_plan_type_index][a].id&&(t=this.plan_list[this.ref_plan_type_index][a]);t.surplus_times<=0?Object(p["a"])("此套餐已售罄, 请更换套餐"):(t.iccid=Object(h["j"])("check_iccid"),Object(h["o"])("planInfo",t,"obj"),"100"!==this.ref_plan_type_index?"1"!==this.realnameType?(Object(h["c"])(3),Object(f["a"])("/api/v1/app/plans/renew_info",{user_id:Object(h["j"])("userInfo","obj").account.user_id,rating_id:t.id}).then(function(t){1===t.state?(Object(h["o"])("monthlyMsg",t.data,"obj"),e.$router.push({path:"/weixin/recharge/index",query:{type:e.$route.query.type}})):Object(p["a"])({position:"top",message:t.msg})})):this.directRecharge(t):this.$router.push("/weixin/card/more_flow"))},directRecharge:function(e){var t=this;if(this.authorizedUserInfo.account.user_id){var a={status:this.authorizedUserInfo.account.balance>0?1:0,recharge_price:e.price,price:e.price,iccid:e.iccid||Object(h["j"])("check_iccid"),rating_id:e.id,user_id:Object(h["j"])("userInfo","obj").account.user_id,env:this.client_type,start_time:Object(h["b"])(),type:0,recharge_type:"mifi"===this.global_variables.packed_project?1:0,success_page:"".concat(window.location.protocol,"//").concat(window.location.host,"/weixin/recharge/callback"),failed_page:window.location.href};"alipay"!==this.client_type&&"wechat"!==this.client_type||(a.open_id=(Object(h["j"])("decrypt_data","obj")||{}).openid),"wechat"===this.client_type&&(a.pay_type="WEIXIN"),"alipay"===this.client_type&&(a.pay_type="ALIPAY"),"app"===this.client_type&&(a.open_id=this.authorizedUserInfo.account.user_id,this.appPay.type?a.pay_type="WEIXIN":a.pay_type="ALIPAY"),o["a"].confirm({title:"充值",message:"是否确认充值'".concat(e.name,"'?")}).then(function(){t.finalRecharge(a)}).catch(function(){})}else Object(p["a"])({position:"top",message:"请在微信或支付宝客户端充值"})},finalRecharge:function(e){var t=this;this.rechargeShow=!0;var a=document.querySelector("form");a&&document.removeChild(a);var i=this;Object(f["b"])("/api/v1/pay/weixin/create",e).then(function(e){if(1===e.state){if(t.rechargeShow=!1,/<[^>]+>/.test(e.data)){var a=document.createElement("div");a.innerHTML=e.data,document.body.appendChild(a),document.forms[0].submit()}e.data&&"[object String]"===Object.prototype.toString.call(e.data)&&"http"===e.data.substr(0,4)?"mifi"===t.global_variables.packed_project?location.href="".concat(t.global_variables.authorized_redirect_url,"/mifi/card/index"):location.href=e.data:(Object(c["a"])({message:"创建订单成功",background:"#60ce53"}),setTimeout(function(){"esim"===localStorage.getItem("currentType")?location.href="".concat(i.global_variables.authorized_redirect_url,"/weixin/card/esim_usage"):"mifi"===i.global_variables.packed_project?location.href="".concat(i.global_variables.authorized_redirect_url,"/mifi/card/index"):location.href=e.data.return_url},1500))}else t.rechargeShow=!1,Object(c["a"])({message:e.msg})})},compare:function(e){return function(t){var a=t[e];return 1==a?-1:0==a?1:0}},compare2:function(e){return function(t,a){var i=t[e],n=a[e];return i>n?1:i<n?-1:0}},toCard:function(){Object(h["c"])(14),this.$router.push({path:"/weixin/coupon/index"})}}},g=m,v=(a("b004"),a("2877")),b=Object(v["a"])(g,n,s,!1,null,null,null);b.options.__file="plan_list.vue";t["default"]=b.exports},b004:function(e,t,a){"use strict";var i=a("1d44"),n=a.n(i);n.a},b258:function(e,t,a){},c0c2:function(e,t,a){},d399:function(e,t,a){"use strict";var i=a("1988"),n=a("2b0e"),s=a("fe7e"),c=a("6605"),l=["success","fail","loading"],o=Object(s["a"])({render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"van-fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.value,expression:"value"}],class:e.b([e.style,e.position])},["text"===e.style?a("div",[e._v(e._s(e.message))]):e._e(),"html"===e.style?a("div",{domProps:{innerHTML:e._s(e.message)}}):e._e(),"default"===e.style?["loading"===e.type?a("loading",{attrs:{color:"white",type:e.loadingType}}):a("icon",{class:e.b("icon"),attrs:{name:e.type}}),e.isDef(e.message)?a("div",{class:e.b("text")},[e._v("\n        "+e._s(e.message)+"\n      ")]):e._e()]:e._e()],2)])},name:"toast",mixins:[c["a"]],props:{forbidClick:Boolean,message:[String,Number],type:{type:String,default:"text"},loadingType:{type:String,default:"circular"},position:{type:String,default:"middle"},lockScroll:{type:Boolean,default:!1}},data:function(){return{clickable:!1}},computed:{style:function(){return-1!==l.indexOf(this.type)?"default":this.type}},mounted:function(){this.toggleClickale()},destroyed:function(){this.toggleClickale()},watch:{value:function(){this.toggleClickale()},forbidClick:function(){this.toggleClickale()}},methods:{toggleClickale:function(){var e=this.value&&this.forbidClick;if(this.clickable!==e){this.clickable=e;var t=e?"add":"remove";document.body.classList[t]("van-toast--unclickable")}}}}),r=a("a142"),d={type:"text",mask:!1,message:"",value:!0,duration:3e3,position:"middle",loadingType:"circular",forbidClick:!1,overlayStyle:{}},p=function(e){return Object(r["d"])(e)?e:{message:e}},_=[],u=!0,h=Object(i["a"])({},d);function f(){if(r["e"])return{};if(!_.length||!u){var e=new(n["default"].extend(o))({el:document.createElement("div")});document.body.appendChild(e.$el),_.push(e)}return _[_.length-1]}function m(e){return e.overlay=e.mask,e}function g(e){void 0===e&&(e={});var t=f();return e=Object(i["a"])({},h,p(e),{clear:function(){t.value=!1,u||r["e"]||(document.body.removeChild(t.$el),t.$destroy())}}),Object(i["a"])(t,m(e)),clearTimeout(t.timer),e.duration>0&&(t.timer=setTimeout(function(){t.clear()},e.duration)),t}var v=function(e){return function(t){return g(Object(i["a"])({type:e},p(t)))}};["loading","success","fail"].forEach(function(e){g[e]=v(e)}),g.clear=function(e){_.length&&(e?(_.forEach(function(e){e.clear()}),_=[]):u?_[0].clear():_.shift().clear())},g.setDefaultOptions=function(e){Object(i["a"])(h,e)},g.resetDefaultOptions=function(){h=Object(i["a"])({},d)},g.allowMultiple=function(e){void 0===e&&(e=!0),u=!e},g.install=function(){n["default"].use(o)},n["default"].prototype.$toast=g;t["a"]=g},e7e5:function(e,t,a){"use strict";a("68ef"),a("4d75"),a("b258")}}]);
//# sourceMappingURL=plan_list.958b222f.js.map