{"version":3,"sources":["webpack:///./src/views/authority/index.vue?21e5","webpack:///src/views/authority/index.vue","webpack:///./src/views/authority/index.vue?9241","webpack:///./src/views/authority/index.vue","webpack:///./src/views/authority/index.vue?ca48"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","close-on-click-overlay","model","value","callback","$$v","load_user_msg","expression","_v","_s","load_user_info","staticRenderFns","authorityvue_type_script_lang_js_","name","components","_components","Object","defineProperty","popup","dialog","data","client_type","utilies","redirect_uri","created","_this2","decryptData","_this","alert","title","message","then","$router","push","localStorage","getItem","methods","_this3","http","res","error","aliUser","uuid","user_id","openid","headimgurl","avatar","gender","nickname","nick_name","wechatUserData","unionid","login","$emit","showAuthorityError","_this4","code","path","flag","_flag","views_authorityvue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_index_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_less___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_index_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_less___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"2HAAA,MAAAA,EAAA,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,0BAAoCF,EAAA,aAAkBG,OAAOC,0BAAA,GAA+BC,OAAQC,MAAAV,EAAA,cAAAW,SAAA,SAAAC,GAAmDZ,EAAAa,cAAAD,GAAsBE,WAAA,mBAA6BV,EAAA,KAAUE,YAAA,YAAsBN,EAAAe,GAAAf,EAAAgB,GAAAhB,EAAAiB,sBAAA,IACpVC,mICYAC,GACAC,KAAA,QACAC,YAAAC,KAAAC,OAAAC,EAAA,KAAAD,CAAAD,EACAG,EAAA,KAAAL,KADAK,EAAA,MAAAF,OAAAC,EAAA,KAAAD,CAAAD,EAEAI,EAAA,KAAAN,KAFAM,EAAA,MAAAJ,GAIAK,KANA,WAOA,OACAC,YAAAL,OAAAM,EAAA,KAAAN,GACAV,eAAA,EACAI,eAAA,WACAa,aAAAP,OAAAM,EAAA,KAAAN,CAAA,6BAGAQ,QAdA,WAcA,IAAAC,EAAA/B,KACA,cAAAA,KAAA2B,aAAA,WAAA3B,KAAA2B,YACA,GAAAL,OAAAM,EAAA,KAAAN,CAAA,WAAAA,OAAAM,EAAA,KAAAN,CAAA,UAAAA,OAAAM,EAAA,KAAAN,CAAA,UAAAA,OAAAM,EAAA,KAAAN,CAAA,SACAtB,KAAAgC,kBACA,CACA,IAAAC,EAAAjC,KACQsB,OAAAM,EAAA,KAAAN,CAAR,SACQA,OAAAM,EAAA,KAAAN,CAAR,SAEQG,EAAA,KAARS,OACAC,MAAA,OACAC,QAAA,wBACAC,KAAA,WACAN,EAAAF,cAAAP,OAAAM,EAAA,KAAAN,CAAA,eACAW,EAAAK,QAAAC,KAAAR,EAAAF,cAEA,eAAAW,aAAAC,QAAA,eACAV,EAAAO,QAAAC,KAAA,4BACA,SAAAC,aAAAC,QAAA,eACAV,EAAAO,QAAAC,KAAA,2BAEAN,EAAAK,QAAAC,KAAA,8BAMAvC,KAAAsC,QAAAC,KAAA,wBAIAG,SACAV,YADA,WACA,IAAAW,EAAA3C,KACMsB,OAAAsB,EAAA,KAAAtB,CAAN,oCAAAA,OAAAM,EAAA,KAAAN,IAAA,SACAI,KAAAJ,OAAAM,EAAA,KAAAN,CAAA,UACAe,KAAA,SAAAQ,GACA,OAAAA,EAAAC,MAAA,CACA,cAAAH,EAAAhB,YAAA,CACA,IAAAoB,GACAC,KAAAH,EAAAnB,UAAAuB,QACAC,OAAAL,EAAAnB,UAAAuB,QACAE,WAAAN,EAAAnB,UAAA0B,OACAC,OAAA,MAAAR,EAAAnB,UAAA2B,OAAA,IACAC,SAAAT,EAAAnB,UAAA6B,WAEYjC,OAAAM,EAAA,KAAAN,CAAZ,eAAAyB,EAAA,YACA,cAAAJ,EAAAhB,YAAA,CACA,IAAA6B,EAAAX,EAAAnB,UACA8B,EAAAC,UACAD,EAAAN,OAAAM,EAAAC,SAEYnC,OAAAM,EAAA,KAAAN,CAAZ,eAAAkC,EAAA,OAGAb,EAAAe,MAAAb,QAEA,QAAAA,EAAAC,MACAH,EAAAgB,MAAA,YAEAhB,EAAAiB,mBAAA,IAAAf,EAAAC,UAIAY,MAhCA,SAgCAb,GAAA,IAAAgB,EAAA7D,KACMsB,OAAAsB,EAAA,KAAAtB,CAAN,gCAAAA,OAAAM,EAAA,KAAAN,IAAA,SACA0B,KAAA1B,OAAAM,EAAA,KAAAN,CAAA,sBAAA4B,OACAY,KAAAjB,EAAAnB,KAAAoC,OACAzB,KAAA,SAAAQ,GACA,OAAAA,EAAAC,MACUxB,OAAAM,EAAA,KAAAN,CAAV,QAAAuB,EAAAnB,KAAA,UACAmC,EAAAhC,cAAAP,OAAAM,EAAA,KAAAN,CAAA,eACAuC,EAAAvB,QAAAC,KAAAsB,EAAAhC,cAEA,eAAAW,aAAAC,QAAA,eACAoB,EAAAvB,QAAAC,KAAA,4BACA,SAAAC,aAAAC,QAAA,eACAoB,EAAAvB,QAAAC,KAAA,2BACA,4BAAAsB,EAAAhC,aACAgC,EAAAvB,QAAAC,KAAAsB,EAAAhC,cAEAgC,EAAAvB,QAAAC,KAAA,4BAGA,WAAAM,EAAAC,MACAe,EAAAF,MAAA,iBACA,WAAAd,EAAAC,OAAA,QAAAD,EAAAC,MAAA,CACA,IAAAb,EAAA4B,EAKA5B,EAAAK,QAAAC,MAAAwB,KAAA,gBAGAF,EAAAD,mBAAA,IAAAf,EAAAC,UAKAc,mBApEA,SAoEAI,GACA,IAAA/B,EAAAjC,KACAiE,EAAAD,GAAA,GACMvC,EAAA,KAANS,OACAC,MAAA,OACAC,QAAA,4CAAA6B,EAAA,MACA5B,KAAA,WACAJ,EAAArB,eAAA,EACAqB,EAAAjB,eAAA,OAAAiD,OCtI8VC,EAAA,0BCQ9VC,EAAgB7C,OAAA8C,EAAA,KAAA9C,CACd4C,EACApE,EACAmB,GACF,EACA,KACA,KACA,MAIAkD,EAAAE,QAAAC,OAAA,YACeC,EAAA,WAAAJ,sECpBf,IAAAK,EAAAC,EAAA,QAAAC,EAAAD,EAAAE,EAAAH,GAAgiBE,EAAG","file":"js/authority_middle.46006d1f.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"authority-middle-wrap\"},[_c('van-popup',{attrs:{\"close-on-click-overlay\":false},model:{value:(_vm.load_user_msg),callback:function ($$v) {_vm.load_user_msg=$$v},expression:\"load_user_msg\"}},[_c('p',{staticClass:\"showTip\"},[_vm._v(_vm._s(_vm.load_user_info))])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"authority-middle-wrap\">\n    <van-popup :close-on-click-overlay=\"false\" v-model=\"load_user_msg\">\n      <p class=\"showTip\">{{load_user_info}}</p>\n    </van-popup>\n  </div>\n</template>\n\n<script>\n  import {Dialog, Popup} from 'vant'\n  import {_post} from \"../../http\";\n  import {getUrlParam, getStorage, setStorage, removeStorage, codeParam, checkBrowser} from \"../../utilies\";\n\n  export default {\n    name: \"index\",\n    components: {\n      [Popup.name]: Popup,\n      [Dialog.name]: Dialog,\n    },\n    data() {\n      return {\n        client_type: checkBrowser(),\n        load_user_msg: false,\n        load_user_info: '正在授权,请等候',\n        redirect_uri: getStorage('authorized_redirect_uri')\n      }\n    },\n    created() {\n      if (this.client_type === 'wechat' || this.client_type === 'alipay') {\n        if (getStorage('state') === getUrlParam('state') && getStorage('state') && getUrlParam('state')) {\n          this.decryptData();\n        } else {\n          let _this = this;\n          removeStorage('token');\n          removeStorage('state');\n\n          Dialog.alert({\n            title: '绑定失败',\n            message: '您的账号信息绑定失败,请重新授权绑定。',\n          }).then(() => {\n            if (this.redirect_uri && getStorage('check_iccid')) {\n              _this.$router.push(this.redirect_uri);\n            } else {\n              if (localStorage.getItem(\"currentType\") === \"userCenter\") {\n                this.$router.push('/weixin/userCenter/index');\n              } else if (localStorage.getItem(\"currentType\") === \"esim\") {\n                this.$router.push('/weixin/card/esim_usage');\n              } else {\n                _this.$router.push('/weixin/card/lookup');\n              }\n            }\n          })\n        }\n      } else {\n        this.$router.push('/weixin/card/lookup')\n      }\n    },\n\n    methods: {\n      decryptData() {\n        _post('/accountCenter/v2/secret/decrypt?' + codeParam({}, 'post'), {\n          data: getUrlParam('data')\n        }).then(res => {\n          if (res.error === 0) {\n            if (this.client_type === 'alipay') {\n              let aliUser = {\n                uuid: res.data.data.user_id,\n                openid: res.data.data.user_id,\n                headimgurl: res.data.data.avatar,\n                gender: res.data.data.gender === 'm' ? 1 : 2,\n                nickname: res.data.data.nick_name\n              };\n              setStorage('decrypt_data', aliUser, 'obj');\n            } else if (this.client_type === 'wechat') {\n              let wechatUserData = res.data.data;\n              if (wechatUserData.unionid) {\n                wechatUserData.openid = wechatUserData.unionid\n              }\n              setStorage('decrypt_data', wechatUserData, 'obj');\n            }\n            //login\n            this.login(res);\n\n          } else if (res.error === 11002) {\n            this.$emit('getToken')\n          } else {\n            this.showAuthorityError('B' + res.error)\n          }\n        })\n      }, // 解密data\n      login(res) {\n        _post('/accountCenter/v2/auth/login?' + codeParam({}, 'post'), {\n          uuid: getStorage('decrypt_data', 'obj').openid,\n          code: res.data.code\n        }).then(res => {\n          if (res.error === 0) {\n            setStorage('token', res.data, 'str', true);//获取token\n            if (this.redirect_uri && getStorage('check_iccid')) {\n              this.$router.push(this.redirect_uri);\n            } else {\n              if (localStorage.getItem(\"currentType\") === \"userCenter\") {\n                this.$router.push('/weixin/userCenter/index');\n              } else if (localStorage.getItem(\"currentType\") === \"esim\") {\n                this.$router.push('/weixin/card/esim_usage');\n              } else if (this.redirect_uri==\"/weixin/userCenter/index\")\n                this.$router.push(this.redirect_uri);\n              else {\n                this.$router.push('/weixin/card/lookup');\n              }\n            }\n          } else if (res.error === 11002) {\n            this.$emit('getToken')\n          } else if (res.error === 30005 || res.error === 11003) {\n            let _this = this;\n            // Dialog.alert({\n            //   title: '绑定信息',\n            //   message: '为了您的账号安全，需要绑定您的手机号码',\n            // }).then(() => {\n              _this.$router.push({path: '/login'})\n            // })\n          } else {\n            this.showAuthorityError('L' + res.error)\n          }\n        })\n      }, // 登录\n\n      showAuthorityError(flag) {\n        let _this = this;\n        let _flag = flag ? flag : '';\n        Dialog.alert({\n          title: '账号异常',\n          message: '您的账户信息存在问题,无法进行操作,请联系我司客服工作人员,我们将尽快为您解决问题' + _flag + '。',\n        }).then(() => {\n          _this.load_user_msg = true;\n          _this.load_user_info = '账号异常' + _flag;\n\n        })\n      },// 拦截错误信息\n    }\n  }\n</script>\n\n<style lang=\"less\">\n  body, html {\n    height: 100%;\n  }\n\n  .authority-middle-wrap {\n    display: flex;\n    height: 100%;\n    align-items: center;\n    justify-content: center;\n    /*background: #00b6f3;*/\n    /*background: #8c8c8c;*/\n\n    [class*=\"loader-\"] {\n      display: inline-block;\n      width: 1em;\n      height: 1em;\n      color: inherit;\n      vertical-align: middle;\n      pointer-events: none;\n    }\n\n    .box {\n      display: inline-block;\n      font-size: 40px;\n      color: #fff;\n      transition: .3s color, .3s border;\n    }\n\n    .loader-14 {\n      border-radius: 50%;\n      box-shadow: 0 1em 0 -.2em currentcolor;\n      position: relative;\n      -webkit-animation: loader-14 0.8s ease-in-out alternate infinite;\n      animation: loader-14 0.8s ease-in-out alternate infinite;\n      -webkit-animation-delay: 0.32s;\n      animation-delay: 0.32s;\n      top: -1em;\n    }\n\n    .loader-14:after,\n    .loader-14:before {\n      content: '';\n      position: absolute;\n      width: inherit;\n      height: inherit;\n      border-radius: inherit;\n      box-shadow: inherit;\n      -webkit-animation: inherit;\n      animation: inherit;\n    }\n\n    .loader-14:before {\n      left: -1em;\n      -webkit-animation-delay: 0.48s;\n      animation-delay: 0.48s;\n    }\n\n    .loader-14:after {\n      right: -1em;\n      -webkit-animation-delay: 0.16s;\n      animation-delay: 0.16s;\n    }\n\n    @-webkit-keyframes loader-14 {\n      0% {\n        box-shadow: 0 2em 0 -.2em currentcolor;\n      }\n      100% {\n        box-shadow: 0 1em 0 -.2em currentcolor;\n      }\n    }\n    @keyframes loader-14 {\n      0% {\n        box-shadow: 0 2em 0 -.2em currentcolor;\n      }\n      100% {\n        box-shadow: 0 1em 0 -.2em currentcolor;\n      }\n    }\n\n  }\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=76f67d53&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"index.vue\"\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}