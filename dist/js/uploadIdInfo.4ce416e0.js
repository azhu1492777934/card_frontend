(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["uploadIdInfo"],{6254:function(t,e,a){},"9d5e":function(t,e,a){"use strict";a.r(e);var i,n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upload-id-card-wrapper",attrs:{id:"canvas-wrapper"}},[a("div",{staticClass:"step-bar-wrapper"},[a("div",{class:{active:0===t.step}},[a("div",{staticClass:"step-line step-one"}),a("div",{staticClass:"step-circle"},[a("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.step>0,expression:"step>0"}],attrs:{name:"success"}})],1),t._m(0)]),a("div",{class:{active:1===t.step}},[a("div",{staticClass:"step-line step-last"}),a("div",{staticClass:"step-circle"},[a("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.step>1,expression:"step>1"}],attrs:{name:"success"}})],1),t._m(1)])]),a("div",{staticClass:"step-content-wrapper",class:{none:0!==t.step}},[t._m(2),t._m(3),a("div",{staticClass:"step-camera-wrapper"},[a("div",{staticClass:"step-icon-camera"},[a("input",{staticClass:"btn-upload",attrs:{type:"file",capture:"camera",accept:"image/*"},on:{change:function(e){return t.handleUpload(e,0)}}})]),a("div",{staticClass:"btn-tip"},[t._v("拍摄身份证人像面")])])]),a("div",{staticClass:"step-content-wrapper",class:{none:1!==t.step}},[t._m(4),t._m(5),a("div",{staticClass:"step-camera-wrapper"},[a("div",{staticClass:"step-icon-camera"},[a("input",{staticClass:"btn-upload",attrs:{type:"file",capture:"camera",accept:"image/*"},on:{change:function(e){return t.handleUpload(e,1)}}})]),a("div",{staticClass:"btn-tip"},[t._v("拍摄身份者国徽面")])])]),a("div",{staticClass:"step-content-wrapper",class:{none:2!==t.step}},[t._m(6),t._m(7),a("div",{staticClass:"step-camera-wrapper step-camera-third"},[a("div",{staticClass:"step-icon-camera"},[a("input",{staticClass:"btn-upload",attrs:{type:"file",capture:"camera",accept:"image/*"},on:{change:function(e){return t.handleUpload(e,2)}}})]),a("div",{staticClass:"btn-tip"},[t._v("拍摄正面免冠照")])])]),a("div",{staticClass:"step-loading-wrapper"},[a("van-popup",{attrs:{"close-on-click-overlay":!1},model:{value:t.showLoading,callback:function(e){t.showLoading=e},expression:"showLoading"}},[a("van-loading",{attrs:{color:"#faca07"}}),a("div",[t._v(t._s(t.loadingMsg))])],1)],1)])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"step-content"},[a("div",[t._v("身份证人像面")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"step-content"},[a("div",[t._v("身份证国徽面")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"step-tip-wrapper"},[a("p",{staticClass:"step-tip"},[t._v("真实拍摄身份证原件，无反光，无水印")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"step-content-first"},[a("div",{staticClass:"origin-img origin-img-first"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"step-tip-wrapper"},[a("p",{staticClass:"step-tip"},[t._v("真实拍摄身份证原件，无反光，无水印")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"step-content-second"},[a("div",{staticClass:"origin-img origin-img-second"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"step-tip-wrapper"},[a("p",{staticClass:"step-tip"},[t._v("真实拍摄持证人正面免冠照")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"step-content-third"},[a("div",{staticClass:"origin-img origin-img-third"})])}],c=(a("6762"),a("a322")),o=(a("68ef"),a("09fe"),a("ad06")),r=(a("9a83"),a("f564")),l=(a("8a58"),a("e41f")),d=(a("e7e5"),a("d399")),p=(a("7f7f"),a("ac1e"),a("543e")),u=(a("cadf"),a("551c"),a("097d"),a("db04")),f=a("35df"),v={name:"uploadIdCard",data:function(){return{step:0,previewUrl_0:null,previewUrl_1:null,img_file_0:null,img_file_1:null,showLoading:!1,loadingMsg:"",iccid:"",imei:"",phone:""}},components:(i={},Object(c["a"])(i,p["a"].name,p["a"]),Object(c["a"])(i,d["a"].name,d["a"]),Object(c["a"])(i,l["a"].name,l["a"]),Object(c["a"])(i,r["a"].name,r["a"]),Object(c["a"])(i,o["a"].name,o["a"]),i),created:function(){var t=Object(f["i"])("cardData","obj"),e=this;t||(Object(r["a"])({message:"信息丢失,即将跳转"}),setTimeout(function(){e.$router.push("/weixin/card/lookup")},2e3)),this.iccid=t.iccid,this.imei=t.imei,this.phone=t.phone},methods:{handleUpload:function(t,e){var a=this,i=t.currentTarget.files[0];if(i){var n=i.name.lastIndexOf("."),s=i.name.substring(n+1).toLowerCase(),c=["png","jpg","jpeg"];if(!c.includes(s))return;this.showLoading=!0;var o=document.createElement("canvas"),r=o.getContext("2d");if(i){var l=window.URL.createObjectURL(i),p=new Image;p.onload=function(){console.log("onload"),o.width=p.width,o.height=p.height,r.clearRect(0,0,o.width,o.height);var t=i.size/1024>1025?.5:.7;r.drawImage(p,0,0,p.width,p.height),a["previewUrl_".concat(e)]=o.toDataURL("image/jpeg",t),a.showLoading=!1,a["previewUrl_".concat(e)]?a.uploadImgs(e):Object(d["a"])({position:"top",message:"您上传的照片处理失败，请重新上传"})},p.src=l}}},uploadImgs:function(t){var e=this,a=this;this.showLoading=!0;var i=new FormData;i.append("file",this["previewUrl_".concat(t)]),Object(u["b"])("/verification/v1/upload/image",i).then(function(i){e.showLoading=!1,0===i.error&&200===i.status?(a["img_file_".concat(t)]=i.data,a.step=++t,a.step>1&&a.verifyInfo()):Object(r["a"])({message:i.msg})})},verifyInfo:function(){this.loadingMsg="正在验证您的信息,请等候认证结果",this.showLoading=!0;var t=new FormData;t.append("iccid",this.iccid),t.append("imei",this.imei),t.append("front",this.img_file_0),t.append("back",this.img_file_1),t.append("mobile",this.phone),Object(u["b"])("/verification//v1/user/valids",t).then(function(t){0===t.error&&200===t.data.code&&$("")})}}},m=v,h=(a("9f41"),a("2877")),g=Object(h["a"])(m,n,s,!1,null,null,null);g.options.__file="uploadIdCard.vue";e["default"]=g.exports},"9f41":function(t,e,a){"use strict";var i=a("6254"),n=a.n(i);n.a},b258:function(t,e,a){},d399:function(t,e,a){"use strict";var i=a("1988"),n=a("2b0e"),s=a("d282"),c=a("a142"),o=a("6605"),r=a("ad06"),l=a("543e"),d=Object(s["a"])("toast"),p=d[0],u=d[1],f=p({mixins:[o["a"]],props:{icon:String,className:null,loadingType:String,forbidClick:Boolean,message:[String,Number],type:{type:String,default:"text"},position:{type:String,default:"middle"},lockScroll:{type:Boolean,default:!1}},data:function(){return{clickable:!1}},mounted:function(){this.toggleClickable()},destroyed:function(){this.toggleClickable()},watch:{value:function(){this.toggleClickable()},forbidClick:function(){this.toggleClickable()}},methods:{toggleClickable:function(){var t=this.value&&this.forbidClick;if(this.clickable!==t){this.clickable=t;var e=t?"add":"remove";document.body.classList[e]("van-toast--unclickable")}},onAfterEnter:function(){this.$emit("opened"),this.onOpened&&this.onOpened()},onAfterLeave:function(){this.$emit("closed")}},render:function(t){var e=this.type,a=this.icon,i=this.message,n=this.loadingType,s=a||"success"===e||"fail"===e;function o(){return s?t(r["a"],{class:u("icon"),attrs:{name:a||e}}):"loading"===e?t(l["a"],{class:u("loading"),attrs:{color:"white",type:n}}):void 0}function d(){if(Object(c["b"])(i)&&""!==i)return"html"===e?t("div",{class:u("text"),domProps:{innerHTML:i}}):t("div",{class:u("text")},[i])}return t("transition",{attrs:{name:"van-fade"},on:{afterEnter:this.onAfterEnter,afterLeave:this.onAfterLeave}},[t("div",{directives:[{name:"show",value:this.value}],class:[u([this.position,{text:!s&&"loading"!==e}]),this.className]},[o(),d()])])}}),v={icon:"",type:"text",mask:!1,value:!0,message:"",className:"",onClose:null,onOpened:null,duration:3e3,position:"middle",forbidClick:!1,loadingType:void 0,getContainer:"body",overlayStyle:null},m=[],h=!1,g=Object(i["a"])({},v);function b(t){return Object(c["c"])(t)?t:{message:t}}function w(){if(c["d"])return{};if(!m.length||h){var t=new(n["default"].extend(f))({el:document.createElement("div")});m.push(t)}return m[m.length-1]}function C(t){return t=Object(i["a"])({},t),t.overlay=t.mask,delete t.mask,delete t.duration,t}function _(t){void 0===t&&(t={});var e=w();return e.value&&e.updateZIndex(),t=Object(i["a"])({},g,b(t),{clear:function(){e.value=!1,t.onClose&&t.onClose(),h&&!c["d"]&&e.$on("closed",function(){clearTimeout(e.timer),m=m.filter(function(t){return t!==e});var t=e.$el.parentNode;t&&t.removeChild(e.$el),e.$destroy()})}}),Object(i["a"])(e,C(t)),clearTimeout(e.timer),t.duration>0&&(e.timer=setTimeout(function(){e.clear()},t.duration)),e}var O=function(t){return function(e){return _(Object(i["a"])({type:t},b(e)))}};["loading","success","fail"].forEach(function(t){_[t]=O(t)}),_.clear=function(t){m.length&&(t?(m.forEach(function(t){t.clear()}),m=[]):h?m.shift().clear():m[0].clear())},_.setDefaultOptions=function(t){Object(i["a"])(g,t)},_.resetDefaultOptions=function(){g=Object(i["a"])({},v)},_.allowMultiple=function(t){void 0===t&&(t=!0),h=t},_.install=function(){n["default"].use(f)},n["default"].prototype.$toast=_;e["a"]=_},e7e5:function(t,e,a){"use strict";a("68ef"),a("4d75"),a("09fe"),a("b258")}}]);
//# sourceMappingURL=uploadIdInfo.4ce416e0.js.map