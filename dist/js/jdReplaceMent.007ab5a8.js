(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["jdReplaceMent"],{"7ece":function(e,t,a){},"8df6":function(e,t,a){"use strict";var s=a("7ece"),i=a.n(s);i.a},c3a6:function(e,t,a){"use strict";a("68ef"),a("9d70"),a("09fe"),a("3743")},efb8:function(e,t,a){"use strict";a.r(t);var s,i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"eqReplaceMent"},[a("div",{staticClass:"usage-wrap hide-user"},[a("div",{ref:"orderTop",staticClass:"order-top"},[a("ul",e._l(e.statusList,function(t,s){return a("li",{key:s,class:{checked:e.statusIndex==s},on:{click:function(t){e.changeStatus(s)}}},[e._v("\n          "+e._s(t)+"\n          "),a("span",{staticClass:"deco-border-arrow"})])}))]),a("div",{ref:"SwiperWwrap",staticClass:"swipe-wrap"},[a("div",{directives:[{name:"show",rawName:"v-show",value:0==e.statusIndex,expression:"statusIndex==0"}]},[a("ul",[a("li",{staticClass:"borderStyle"},[e._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:e.replaceData.iccid,expression:"replaceData.iccid"}],attrs:{placeholder:"请输入要更换卡的卡号",type:"text"},domProps:{value:e.replaceData.iccid},on:{input:function(t){t.target.composing||e.$set(e.replaceData,"iccid",t.target.value)}}}),a("i",{staticClass:"scanCode",on:{click:function(t){e.scanIccid(1)}}})]),a("li",{class:{marginStyle:!e.newIccid}},[e._m(1),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newIccid,expression:"newIccid"}],attrs:{placeholder:"请选择",type:"text",readonly:""},domProps:{value:e.newIccid},on:{focus:function(t){e.showIccid=!0},input:function(t){t.target.composing||(e.newIccid=t.target.value)}}})]),a("li",{staticClass:"borderStyle"},[e._m(2),a("input",{directives:[{name:"model",rawName:"v-model",value:e.replaceData.user_name,expression:"replaceData.user_name"}],attrs:{placeholder:"请输入收件人姓名",type:"text"},domProps:{value:e.replaceData.user_name},on:{input:function(t){t.target.composing||e.$set(e.replaceData,"user_name",t.target.value)}}})]),a("li",{staticClass:"borderStyle"},[e._m(3),a("input",{directives:[{name:"model",rawName:"v-model",value:e.replaceData.mobile,expression:"replaceData.mobile"}],attrs:{placeholder:"请输入老设备实名手机号",type:"number"},domProps:{value:e.replaceData.mobile},on:{input:function(t){t.target.composing||e.$set(e.replaceData,"mobile",t.target.value)}}})]),a("li",{staticClass:"marginStyle"},[e._m(4),a("input",{directives:[{name:"model",rawName:"v-model",value:e.replaceData.code,expression:"replaceData.code"}],attrs:{placeholder:"请输入短信验证码",type:"text"},domProps:{value:e.replaceData.code},on:{input:function(t){t.target.composing||e.$set(e.replaceData,"code",t.target.value)}}}),a("span",{staticClass:"getCode",on:{click:function(t){e.getCode(e.replaceData.mobile)}}},[e._v(e._s(e.codeText))])]),a("li",{staticClass:"borderStyle"},[e._m(5),a("input",{directives:[{name:"model",rawName:"v-model",value:e.areaData,expression:"areaData"}],attrs:{placeholder:"请选择省市区街道",type:"text",readonly:""},domProps:{value:e.areaData},on:{focus:function(t){e.show=!0},input:function(t){t.target.composing||(e.areaData=t.target.value)}}})]),a("li",{attrs:{stye:"-webkit-user-select:text !important;"}},[e._m(6),a("input",{directives:[{name:"model",rawName:"v-model",value:e.replaceData.addr,expression:"replaceData.addr"}],attrs:{placeholder:"请输入详细地址",type:"text"},domProps:{value:e.replaceData.addr},on:{input:function(t){t.target.composing||e.$set(e.replaceData,"addr",t.target.value)}}})])]),a("div",{staticClass:"submitButton"},[a("div",{on:{click:function(t){e.submit()}}},[e._v("提交")]),a("div",[e._v("注：请仔细核对信息后再提交")]),a("div",[e._v("1.新卡1-3个工作日发出")]),a("div",[e._v("2.快件发出后方可在“物流查询”界面查询快递信息")])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.statusIndex,expression:"statusIndex==1"}]},[e._l(e.replaceList,function(t,s){return a("div",{key:s,staticClass:"replaceList"},[a("div",{staticClass:"wrapBox1"},[t.model_name?a("div",{staticClass:"wrapBox2"},[a("div",[e._v("设备型号")]),a("div",[e._v(e._s(t.model_name))])]):e._e(),t.model_name?e._e():a("div",{staticClass:"wrapBox2"},[a("div"),a("div",[e._v("卡更换")])]),a("div",{staticClass:"wrapBox3"},[t.iccid?a("div",[a("span",[e._v("ICCID   ")]),a("span",[e._v(e._s(t.iccid))])]):e._e(),a("div",[a("span",[e._v("物流公司")]),t.express_name?a("span",[e._v(e._s(t.express_name))]):e._e(),t.express_name?e._e():a("span",[e._v("暂无物流信息")])]),a("div",[a("span",[e._v("快递单号")]),t.express_no?a("span",[e._v(e._s(t.express_no))]):e._e(),t.express_no?e._e():a("span",[e._v("暂无物流信息")])])])]),a("div",{staticClass:"wrapBox4"},[t.operator_at?a("div",[e._v(" 发货时间: "+e._s(t.operator_at)+" ")]):e._e(),t.operator_at?e._e():a("span",[e._v("暂无物流信息")]),t.operator_at?a("div",{staticClass:"cfmButton",class:{unreceived:1==t.plan_transfer}},[1!=t.plan_transfer?a("span",{on:{click:function(a){e.cfmButton(t.id,t.new_source,t.new_iccid)}}},[e._v("确认收货")]):e._e(),1==t.plan_transfer?a("span",[e._v("已收货")]):e._e()]):e._e()])])}),0==e.replaceList.length?a("div",{staticClass:"noMsg"},[e._v("暂无物流记录")]):e._e()],2)]),a("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[a("van-area",{attrs:{"area-list":e.areaList},on:{cancel:function(t){e.show=!1},confirm:e.getAreaList}})],1),a("van-popup",{style:{height:"55%"},attrs:{round:"",position:"bottom",closeable:!0},model:{value:e.showIccid,callback:function(t){e.showIccid=t},expression:"showIccid"}},[a("div",{staticClass:"showIccid"},[a("div",{staticClass:"iccidTitle"},[e._v("请选择号码")]),a("div",{staticClass:"container"},e._l(e.newIccidList,function(t,s){return a("div",{key:s,staticClass:"item",on:{click:function(t){e.getChooseIccid(t)}}},[e._v(e._s(t))])})),a("div",{staticClass:"changeIccid"},[a("input",{attrs:{type:"button",value:"换一批"},on:{click:function(t){e.changeNewIccidList()}}}),a("van-icon",{attrs:{name:"replay"}})],1)])])],1)])},c=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("span",{staticClass:"redWord"},[e._v("*")]),e._v(" ICCID卡号:")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("span",{staticClass:"redWord"},[e._v("*")]),e._v("新的卡号:")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("span",{staticClass:"redWord"},[e._v("*")]),e._v(" 收件人姓名:")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("span",{staticClass:"redWord"},[e._v("*")]),e._v(" 手机号码:")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("span",{staticClass:"redWord"},[e._v("*")]),e._v(" 验证码:")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("span",{staticClass:"redWord"},[e._v("*")]),e._v(" 所在地区:")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("span",{staticClass:"redWord"},[e._v("*")]),e._v("详细地址:")])}],n=(a("e17f"),a("2241")),r=(a("a481"),a("96cf"),a("3040")),o=(a("9a83"),a("f564")),d=a("a322"),l=(a("db2c"),a("1125")),u=(a("c3a6"),a("ad06")),p=(a("ac1e"),a("543e")),m=(a("8a58"),a("e41f")),v=(a("7f7f"),a("e7e5"),a("d399")),h=(a("cadf"),a("551c"),a("097d"),a("7212")),f=a("35df"),_=a("db04"),b=a("851b"),g={name:"jdReplaceMent",components:(s={},Object(d["a"])(s,v["a"].name,v["a"]),Object(d["a"])(s,m["a"].name,m["a"]),Object(d["a"])(s,p["a"].name,p["a"]),Object(d["a"])(s,u["a"].name,u["a"]),Object(d["a"])(s,"swiper",h["swiper"]),Object(d["a"])(s,"swiperSlide",h["swiperSlide"]),Object(d["a"])(s,"vanArea",l["a"]),s),data:function(){var e=this;return{today:Object(f["b"])(),timeStamp:(new Date).getTime(),iccid:Object(f["j"])("check_iccid"),source:Object(f["j"])("check_realNameSource"),client_type:Object(f["d"])(),statusList:["卡更换"],statusIndex:0,usageListObj:{},swiperOption:{on:{slideChangeTransitionEnd:function(t){e.statusIndex=this.activeIndex}}},replaceData:{model_name:"",user_name:"",mobile:"",code:"",province:"",city:"",district:"",addr:"",iccid:""},areaData:"",codeText:"获取验证码",countdown:60,show:!1,areaList:b["a"],replaceList:[],currentType:1,gift:2,youku_mobile:"",showIccid:!1,count:1,newIccid:"",step:0,newIccidList:[],newIccidTotal:[],newIccidData:[]}},created:function(){this.initial()},computed:{},methods:{initial:function(){this.getNewIccidList()},changeStatus:function(e){this.statusIndex=e,1==e&&this.getList(),this.replaceData={model_name:"",user_name:"",mobile:"",code:"",province:"",city:"",district:"",addr:"",iccid:""},this.areaData="",this.gift=2,this.youku_mobile=""},changeNewIccidList:function(){this.newIccidList=[],this.step>this.newIccidTotal.length-1&&(this.step=0);for(var e=0;e<=9;e++)this.newIccidList.push(this.newIccidTotal[this.step]),this.step++},getNewIccidList:function(){var e=this;Object(_["a"])("/iot/v1/weixin/cards/get_lianghao",{iccid:this.newIccid}).then(function(t){if(1==t.status){e.newIccidData=t.data,e.newIccidData.map(function(t){e.newIccidTotal.push(t.msisdn)});for(var a=e.newIccidTotal.length>9?9:e.newIccidTotal.length-1,s=0;s<=a;s++)e.newIccidList.push(e.newIccidTotal[e.step]),e.step++;console.log(e.newIccidList)}})},getList:function(){var e=this;Object(_["a"])("/api/v1/app/equipment/change/apply_list",{user_id:Object(f["j"])("userInfo","obj").account.user_id,type:this.currentType,offset:0,limit:999}).then(function(t){1==t.state?e.replaceList=t.data.rows:Object(o["a"])({message:t.msg})})},getCode:function(e){return e&&""!=e?/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/.test(this.replaceData.mobile)?(this.countDownFun(),void Object(_["b"])("/api/v1/app/messages/send",{mobile:e,status:3}).then(function(e){1==e.state?Object(o["a"])({message:"验证码发送成功",background:"#60ce53"}):Object(o["a"])({message:e.msg})})):(Object(o["a"])({message:"请填写正确的手机号码"}),!1):(Object(o["a"])({message:"请填写手机号码"}),!1)},getChooseIccid:function(e){this.newIccid=e.target.innerText,this.showIccid=!1},countDownFun:function(){var e=this,t=this;clearInterval(this.timer),this.timer=setInterval(function(){t.countdown<=0?(t.codeText="获取验证码",t.countdown=60,clearInterval(t.timer)):(t.codeText=e.countdown+"s",t.countdown--)},1e3)},getAreaList:function(e){this.areaData="",this.replaceData.province=e[0].name,this.replaceData.city=e[1].name,e[2]?this.replaceData.district=e[2].name:this.replaceData.district="";for(var t=[],a=0;a<e.length;a++)e[a]&&t.push(e[a].name);this.areaData=t.join("/"),this.show=!1},submit:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,a,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this,/^[1-9]\d*$/.test(this.replaceData.code)){e.next=5;break}return Object(o["a"])({message:"请填写正确的验证码"}),e.abrupt("return",!1);case 5:if(0!=this.currentType){e.next=9;break}if(""!=this.replaceData.model_name){e.next=9;break}return Object(o["a"])({message:"请填写设备型号"}),e.abrupt("return",!1);case 9:if(""!=this.replaceData.iccid){e.next=12;break}return Object(o["a"])({message:"请填写卡号"}),e.abrupt("return",!1);case 12:if(""!=this.newIccid){e.next=15;break}return Object(o["a"])({message:"请选择新的卡号"}),e.abrupt("return",!1);case 15:if(""!=this.replaceData.user_name){e.next=18;break}return Object(o["a"])({message:"请填写收件人姓名"}),e.abrupt("return",!1);case 18:if(""!=this.replaceData.mobile){e.next=21;break}return Object(o["a"])({message:"请填写手机号"}),e.abrupt("return",!1);case 21:if(""!=this.replaceData.code){e.next=24;break}return Object(o["a"])({message:"请填写验证码"}),e.abrupt("return",!1);case 24:if(""!=this.replaceData.province&&""!=this.replaceData.city&&""!=this.replaceData.district){e.next=27;break}return Object(o["a"])({message:"请选择所在地区"}),e.abrupt("return",!1);case 27:if(""!=this.replaceData.addr){e.next=30;break}return Object(o["a"])({message:"请填写详细地址"}),e.abrupt("return",!1);case 30:if(!(this.replaceData.addr.length<3)){e.next=33;break}return Object(o["a"])({message:"详细地址过短"}),e.abrupt("return",!1);case 33:if(1!=this.gift){e.next=37;break}if(/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/.test(this.youku_mobile)){e.next=37;break}return Object(o["a"])({message:"请填写正确优酷绑定的手机号"}),e.abrupt("return",!1);case 37:for(a in 2==this.gift&&(this.youku_mobile=""),t=this.replaceData,t)t[a]=String(t[a]).replace(/\s*/g,"");t.user_id=0,t.type=this.currentType,t.gift=this.gift,t.youku_mobile=this.youku_mobile,this.newIccidData.some(function(e){e.msisdn==s.newIccid&&(t.new_iccid=e.iccid),console.log(88)}),this.cfmSubmit(t),e.next=51;break;case 48:e.prev=48,e.t0=e["catch"](0),Object(v["a"])({position:"top",message:e.t0.message});case 51:case"end":return e.stop()}},e,this,[[0,48]])}));return function(){return e.apply(this,arguments)}}(),scanIccid:function(e){var t=this;this.wx.scanQRCode({needResult:1,scanType:["barCode","qrCode"],success:function(e){var a=e.resultStr;a.indexOf(",")>-1&&(a=a.substr(a.indexOf(",")+1,a.length)),t.replaceData.iccid=a.replace(/\s*/g,"")}})},cfmButton:function(e,t,a){var s,i=this;s=35==t?"确认且实名":"确认",n["a"].confirm({title:"是否确认收货",message:"确认收货后套餐将自动转移到新卡",confirmButtonText:s}).then(function(){i.transferPlan(e,a)}).catch(function(){})},transferPlan:function(e,t){var a=this;Object(_["b"])("/api/v1/app/equipment/transfer",{id:e}).then(function(e){1==e.state?(0==Object(f["j"])("is_flow_card")&&a.activate(t),Object(o["a"])({message:"确认收货成功",background:"#60ce53"}),a.getList(),e.data&&(location.href=e.data)):Object(o["a"])({message:e.msg})})},cfmSubmit:function(e){var t=this;Object(_["b"])("/api/v1/app/equipment/change/apply",e).then(function(e){if(e.data||1!=e.state)if(/<[^>]+>/.test(e.data)){var a=document.createElement("div");a.innerHTML=e.data,document.body.appendChild(a),document.forms[0].submit()}else Object(o["a"])({message:e.msg});else Object(o["a"])({message:"提交成功",background:"#60ce53"}),t.replaceData={},t.areaData="",t.gift=2,t.youku_mobile="",t.newIccid=""})},getSource:function(e){var t=this,a=new Promise(function(e,a){Object(_["a"])("/api/v1/app/cards/details",{iccid:t.iccid}).then(function(t){1==t.state&&e(t.data.source)})});return a},activate:function(e){Object(_["a"])("/api/v1/app/cards/yd_allow_auth",{iccid:e,user_id:Object(f["j"])("userInfo","obj").account.user_id})}}},w=g,x=(a("8df6"),a("2877")),I=Object(x["a"])(w,i,c,!1,null,null,null);I.options.__file="jdReplaceMent.vue";t["default"]=I.exports}}]);
//# sourceMappingURL=jdReplaceMent.007ab5a8.js.map