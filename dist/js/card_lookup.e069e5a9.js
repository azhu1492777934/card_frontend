(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["card_lookup"],{1892:function(e,c,t){"use strict";var a=t("75b0"),i=t.n(a);i.a},6648:function(e,c,t){"use strict";t.r(c);var a,i=function(){var e=this,c=e.$createElement,a=e._self._c||c;return a("div",["app2"!=e.newAppStyle?a("div",{staticClass:"check-card-wrap"},[a("div",{staticClass:"scanTop-wrap"},["app2"!=e.newAppStyle?a("img",{attrs:{src:t("24b9"),alt:""}}):e._e(),"app2"==e.newAppStyle?a("img",{attrs:{src:t("1564"),alt:""}}):e._e()]),a("div",{staticClass:"search-wrap"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.iccid,expression:"iccid"}],ref:"iccidDom",attrs:{placeholder:"扫码或手动输入iccid号或11位电话号",type:"text"},domProps:{value:e.iccid},on:{focus:e.handleIccidFocus,blur:function(c){return c.preventDefault(),e.iccidBlur(c)},input:function(c){c.target.composing||(e.iccid=c.target.value)}}}),a("span",{directives:[{name:"show",rawName:"v-show",value:e.showClearBtn,expression:"showClearBtn"}],staticClass:"clearIccid",on:{click:e.clearInputIccid}},[e._v("×")]),a("span",{directives:[{name:"show",rawName:"v-show",value:"app"!=e.client_type,expression:"client_type!='app'"}],staticClass:"iconfont icon-scan bounceIn animated",on:{click:e.scanIccid}}),a("span",{directives:[{name:"show",rawName:"v-show",value:"app"!=e.client_type,expression:"client_type!='app'"}],staticClass:"icon-scanTip"})]),a("div",{staticClass:"btn-check-wrap"},[a("card-button",{attrs:{btnText:"查询"},on:{clickThrotle:function(c){e.searchIccid(e.iccid)}}}),a("a",{staticClass:"advert",attrs:{target:"_Blank",href:e.advertisement}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.recording_show,expression:"recording_show"}],staticClass:"recording-wrap"},[a("p",{staticClass:"recording-title"},[a("span",[e._v("历史搜索记录")]),a("span",[e._v(e._s(e.recording_list.length)+"条")])]),a("ul",{staticClass:"recording-list-wrap"},e._l(e.recording_list,function(c,t){return a("li",[a("span",{on:{click:function(t){e.searchIccid(c.iccid)}}},[e._v(e._s(c.iccid))]),a("span",[e._v(e._s(c.searchTime))]),a("span",{on:{click:function(t){e.deleteIccid(c.iccid)}}},[e._v("×")])])}))]),a("van-popup",{attrs:{"close-on-click-overlay":!1},model:{value:e.forbidden_click,callback:function(c){e.forbidden_click=c},expression:"forbidden_click"}})],1):e._e(),"app2"==e.newAppStyle?a("div",{staticClass:"appStyle"},[a("div",{staticClass:"scanTop-wrap"},["app2"!=e.newAppStyle?a("img",{attrs:{src:t("24b9"),alt:""}}):e._e(),"app2"==e.newAppStyle?a("img",{attrs:{src:t("1564"),alt:""}}):e._e()]),a("div",{staticClass:"search-wrap"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.iccid,expression:"iccid"}],ref:"iccidDom",attrs:{placeholder:"扫码或手动输入iccid号或11位电话号",type:"text"},domProps:{value:e.iccid},on:{focus:e.handleIccidFocus,blur:function(c){return c.preventDefault(),e.iccidBlur(c)},input:function(c){c.target.composing||(e.iccid=c.target.value)}}}),a("span",{directives:[{name:"show",rawName:"v-show",value:e.showClearBtn,expression:"showClearBtn"}],staticClass:"clearIccid",on:{click:e.clearInputIccid}},[e._v("×")]),a("span",{directives:[{name:"show",rawName:"v-show",value:"app"!=e.client_type,expression:"client_type!='app'"}],staticClass:"iconfont icon-scan bounceIn animated",on:{click:e.scanIccid}}),a("span",{directives:[{name:"show",rawName:"v-show",value:"app"!=e.client_type,expression:"client_type!='app'"}],staticClass:"icon-scanTip"})]),a("div",{staticClass:"btn-check-wrap"},[a("card-button",{attrs:{btnText:"查询"},on:{clickThrotle:function(c){e.searchIccid(e.iccid)}}}),a("a",{staticClass:"advert",attrs:{target:"_Blank",href:e.advertisement}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.recording_show,expression:"recording_show"}],staticClass:"recording-wrap"},[a("p",{staticClass:"recording-title"},[a("span",[e._v("历史搜索记录")]),a("span",[e._v(e._s(e.recording_list.length)+"条")])]),a("ul",{staticClass:"recording-list-wrap"},e._l(e.recording_list,function(c,t){return a("li",[a("span",{on:{click:function(t){e.searchIccid(c.iccid)}}},[e._v(e._s(c.iccid))]),a("span",[e._v(e._s(c.searchTime))]),a("span",{on:{click:function(t){e.deleteIccid(c.iccid)}}},[e._v("×")])])}))]),a("van-popup",{attrs:{"close-on-click-overlay":!1},model:{value:e.forbidden_click,callback:function(c){e.forbidden_click=c},expression:"forbidden_click"}})],1):e._e()])},n=[],s=(t("6762"),t("e17f"),t("2241")),r=(t("96cf"),t("3040")),o=(t("55dd"),t("a481"),t("9a83"),t("f564")),l=t("a322"),d=(t("e7e5"),t("d399")),p=(t("7f7f"),t("8a58"),t("e41f")),h=(t("cadf"),t("551c"),t("097d"),t("35df")),u=t("db04"),_=t("4e3c"),b=t("fa47"),m={name:"home",data:function(){return{advertisement:"https://interaction.clotfun.online/horse?appkey=19a9a0d6ce1cc847fcf213dc9d75ade8&adSpaceKey=d66eb4937fdfb2e9b63ea6712cfa7881&from=H5&1=1",realnameType:0,sort_recording_list:{},recording_list:[],recording_show:!1,iccid:"",checkShow:!0,client_type:Object(h["d"])(),showClearBtn:!1,forbidden_click:!0,newAppStyle:"app"}},components:(a={},Object(l["a"])(a,p["a"].name,p["a"]),Object(l["a"])(a,d["a"].name,d["a"]),Object(l["a"])(a,"Empty",b["a"]),Object(l["a"])(a,"cardButton",_["a"]),a),created:function(){Object(h["p"])("is_watch_card"),Object(h["p"])("MiGuMusic"),Object(h["p"])("realnameType"),Object(h["p"])("plan_list_new_card"),Object(h["p"])("hasValidatedPlan"),Object(h["p"])("balance_pay"),this.$store.commit("userInfo/changeCanBalancePay",!1);var e=navigator.userAgent.toLowerCase();/(app_charge)/.test(e)?(this.newAppStyle="app2",localStorage.setItem("newAppStyle","app2")):localStorage.setItem("newAppStyle","app"),("wechat"!==this.client_type||"alipay"!==this.client_type||"app"!==this.client_type||Object(h["j"])("token"))&&(this.forbidden_click=!1),Object(h["j"])("userInfo","obj")&&Object(h["n"])({type:2,user_id:Object(h["j"])("userInfo","obj")?Object(h["j"])("userInfo","obj").account.user_id:""});var c=this;if(Object(h["j"])("recording_list","arr")){var t=Object(h["j"])("recording_list","arr");t.length&&(this.recording_list=t,this.recording_show=!0)}Object(h["j"])("new_auth_search_iccid")?this.iccid=Object(h["j"])("new_auth_search_iccid"):Object(h["j"])("check_iccid")&&(this.iccid=Object(h["j"])("check_iccid")),this.$watch("iccid",this.debounce(function(e){c.handleIccidFocus()},500));var a=Object(h["k"])("iccid")||Object(h["j"])("watch_card");if(a&&1===this.checkSearchIccid(a).state)if(Object(h["j"])("watchAutoSearch")>2&&(Object(h["p"])("watch_card"),Object(h["p"])("watchAutoSearch")),Object(h["j"])("watch_card_timestamp")){var i=Object(h["j"])("watch_card_timestamp"),n=(new Date).getTime();if(n>i){var s=(new Date).getTime()+6e4;Object(h["q"])("check_iccid",a),Object(h["q"])("watch_card_timestamp",s),this.processCheckIccid(a)}}else{this.iccid=a,Object(h["q"])("check_iccid",a);var r=(new Date).setTime((new Date).getTime()+6e4);Object(h["q"])("watch_card_timestamp",r),this.processCheckIccid(a)}else a&&Object(o["a"])({message:this.checkSearchIccid(a).msg});Object(h["k"])("iccid")&&this.processCheckIccid(Object(h["k"])("iccid"))},methods:{getRealnameType:function(e,c){var t=this,a=Object(d["a"])({duration:0,forbidClick:!0});Object(u["a"])("/api/v1/app/realnametype",{iccid:e}).then(function(i){if(a.clear(),1===i.state&&(t.realnameType=i.data.real_name_type),1===t.realnameType&&1===i.data.order_status)return Object(h["q"])("realnameType",t.realnameType),void t.$router.push("/weixin/card/plan_list");Object(h["n"])({type:3,iccid:e}).then(function(e){1===e.state?(1===c&&Object(h["q"])("is_watch_card",1),Object(h["q"])("plan_list_new_card",1),t.$router.push({path:"/weixin/card/plan_list"})):Object(o["a"])({message:e.msg})})})},searchIccid:function(e){e?this.checkSearchIccid(e).state?this.processCheckIccid(e):Object(o["a"])({message:this.checkSearchIccid(e).msg}):Object(o["a"])({message:"请输入ICCID"})},processCheckIccid:function(e){var c,t=this;c=e.replace(/\s/g,""),d["a"].loading({mask:!0,message:"查询中,请等候",forbidClick:!0,duration:0});var a=!1;this.recording_list.length?(this.recording_list.map(function(e,t){e.iccid===c&&(e.searchTime=Object(h["h"])().searchTime,e.millisecond=Object(h["h"])().millisecond,a=!0)}),a||this.recording_list.push({iccid:c,searchTime:Object(h["h"])().searchTime,millisecond:Object(h["h"])().millisecond})):(this.recording_list.push({iccid:c,searchTime:Object(h["h"])().searchTime,millisecond:Object(h["h"])().millisecond}),this.recording_show=!0),this.recording_list.sort(this.compare("millisecond")),this.recording_list.length>20&&this.recording_list.splice(20),Object(h["q"])("recording_list",this.recording_list,"arr",!0),Object(h["c"])(1),Object(u["b"])("/api/v1/app/new_auth/check_auth_",{iccid:c}).then(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(c){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(d["a"].clear(),a=Object(h["j"])("watchAutoSearch"),a&&(a++,Object(h["q"])("watchAutoSearch",a)),1!==c.state){e.next=22;break}if(1!==c.data.is_qiyu){e.next=7;break}return Object(o["a"])({message:"此卡不属于物联网通信运营商"}),e.abrupt("return");case 7:if(!Object(h["j"])("userInfo","obj")){e.next=10;break}return e.next=10,t.getCanBalancePay();case 10:Object(h["q"])("originPrice",c.data.default_price),Object(h["q"])("check_iccid",c.data.iccid),Object(h["q"])("new_auth_search_iccid",c.data.iccid),Object(h["p"])("plan_list_new_card"),Object(h["p"])("advertState"),localStorage.setItem("currentType","card"),1===c.data.is_migu_music&&Object(h["q"])("MiGuMusic",!0),1===c.data.status&&(1===c.data.is_watch&&Object(h["q"])("is_watch_card",1),t.$router.push({path:"/weixin/card/usage"})),2===c.data.status&&t.toRealname(c.data.iccid,c.data.source),3===c.data.status&&(Object(h["q"])("advertState",1),t.getRealnameType(c.data.iccid,c.data.is_watch)),e.next=23;break;case 22:11022===c.state?s["a"].alert({message:"此卡已过期，即将前往换卡页面"}).then(function(){t.$router.push({path:"/weixin/question/eqReplaceMent"})}):Object(o["a"])({message:c.msg});case 23:case"end":return e.stop()}},e,this)}));return function(c){return e.apply(this,arguments)}}())},toRealname:function(e,c){var t=this,a=[45,46],i=!1;a.includes(c)&&(i=!0),Object(h["q"])("check_realNameSource",c),Object(h["n"])({type:3,iccid:e}).then(function(a){1===a.state?Object(u["a"])("/api/v1/app/cards/realname",{iccid:e}).then(function(a){1===a.data||i?window.location.href="".concat(t.global_variables.realname_url,"?iccid=").concat(e,"&source=").concat(c,"&urlType=1"):t.$router.push({path:"/weixin/new_card/real_name"})}):Object(o["a"])({message:a.msg})})},scanIccid:function(){var e=this;"wechat"===this.client_type?this.wx.ready(function(){console.log(e.wx),e.wx.scanQRCode({needResult:1,scanType:["barCode","qrCode"],success:function(c){var t=c.resultStr;t.indexOf(",")>-1&&(t=t.substr(t.indexOf(",")+1,t.length)),e.iccid=t.replace(/\s*/g,""),e.processCheckIccid(e.iccid)},fail:function(e){Object(o["a"])({message:"暂不支持，敬请原谅！"})}})}):"alipay"===this.client_type&&ap.scan(function(c){var t=c.code;e.iccid=t.replace(/\s*/g,""),e.processCheckIccid(e.iccid)})},inArray:function(e,c,t){return null==c?-1:c.indexOf(e,t)},compare:function(e){return function(c,t){var a=c[e],i=t[e];return i-a}},checkSearchIccid:function(e){var c=e.replace(/\s/g,"");return c?(c.length<19||c.length>20||"89"!==c.substr(0,2))&&11!==c.length&&13!==c.length&&15!==c.length&&16!==c.length?{state:0,msg:"ICCID有误,请检查"}:/^[a-zA-Z0-9]+$/.test(c)?{state:1}:{state:0,msg:"ICCID有误,请检查"}:{state:0,msg:"请输入ICCID"}},deleteIccid:function(e){for(var c=-1,t=0;t<this.recording_list.length;t++)if(this.recording_list[t].iccid===e){c=t;break}c>=0&&(this.recording_list.splice(c,1),Object(h["q"])("recording_list",this.recording_list,"arr",!0)),this.recording_list.length||(this.recording_show=!1)},handleIccidFocus:function(){this.iccid?this.showClearBtn=!0:this.showClearBtn=!1},clearInputIccid:function(){this.iccid="",this.$refs.iccidDom.focus(),this.showClearBtn=!1},iccidBlur:function(){this.showClearBtn=!1},debounce:function(e,c){var t,a=this;return function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];t&&clearTimeout(t),t=setTimeout(function(){e.apply(a,n)},c)}},getCanBalancePay:function(){var e=this;Object(u["a"])("/api/v1/app/user/balance_deadline",{user_id:Object(h["j"])("userInfo","obj").account.user_id}).then(function(c){1==c.state&&(1==c.data.in_balance_deadline?(Object(h["q"])("balance_pay",!0),e.$store.commit("userInfo/changeCanBalancePay",!0)):0==c.data.in_balance_deadline&&(Object(h["q"])("balance_pay",!1),e.$store.commit("userInfo/changeCanBalancePay",!1)))})}}},f=m,w=(t("e0b1"),t("2877")),v=Object(w["a"])(f,i,n,!1,null,null,null);v.options.__file="lookup.vue";c["default"]=v.exports},"75b0":function(e,c,t){},c520:function(e,c,t){},e0b1:function(e,c,t){"use strict";var a=t("c520"),i=t.n(a);i.a},fa47:function(e,c,t){"use strict";var a=function(){var e=this,c=e.$createElement,t=e._self._c||c;return t("div",{staticClass:"empty-wrapper"},[t("div",{staticClass:"empty-inner"},[t("div",{staticClass:"no-data-wrapper"}),t("div",{staticClass:"text-wrapper"},[e._v(e._s(e.text))])])])},i=[],n={name:"index",props:{text:{type:String,default:"暂无数据"}}},s=n,r=(t("1892"),t("2877")),o=Object(r["a"])(s,a,i,!1,null,null,null);o.options.__file="index.vue";c["a"]=o.exports}}]);
//# sourceMappingURL=card_lookup.e069e5a9.js.map