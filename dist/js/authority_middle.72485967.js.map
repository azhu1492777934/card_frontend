{"version":3,"sources":["webpack:///./src/views/authority/index.vue?048d","webpack:///src/views/authority/index.vue","webpack:///./src/views/authority/index.vue?9241","webpack:///./src/views/authority/index.vue","webpack:///./src/views/authority/index.vue?ca48"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","close-on-click-overlay","model","value","callback","$$v","load_user_msg","expression","_v","_s","load_user_info","staticRenderFns","authorityvue_type_script_lang_js_","name","components","_components","Object","defineProperty","popup","dialog","data","client_type","utilies","redirect_uri","created","_this2","decryptData","_this","alert","title","message","then","$router","push","localStorage","getItem","methods","_this3","http","res","error","aliUser","uuid","user_id","openid","headimgurl","avatar","gender","nickname","nick_name","wechatUserData","unionid","login","$emit","showAuthorityError","_this4","code","path","flag","_flag","views_authorityvue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_index_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_less___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_index_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_less___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"js/authority_middle.72485967.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"authority-middle-wrap\"},[_c('van-popup',{attrs:{\"close-on-click-overlay\":false},model:{value:(_vm.load_user_msg),callback:function ($$v) {_vm.load_user_msg=$$v},expression:\"load_user_msg\"}},[_c('p',{staticClass:\"showTip\"},[_vm._v(_vm._s(_vm.load_user_info))])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"authority-middle-wrap\">\r\n    <van-popup :close-on-click-overlay=\"false\" v-model=\"load_user_msg\">\r\n      <p class=\"showTip\">{{load_user_info}}</p>\r\n    </van-popup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import {Dialog, Popup} from 'vant'\r\n  import {_post} from \"../../http\";\r\n  import {getUrlParam, getStorage, setStorage, removeStorage, codeParam, checkBrowser} from \"../../utilies\";\r\n\r\n  export default {\r\n    name: \"index\",\r\n    components: {\r\n      [Popup.name]: Popup,\r\n      [Dialog.name]: Dialog,\r\n    },\r\n    data() {\r\n      return {\r\n        client_type: checkBrowser(),\r\n        load_user_msg: false,\r\n        load_user_info: '正在授权,请等候',\r\n        redirect_uri: getStorage('authorized_redirect_uri')\r\n      }\r\n    },\r\n    created() {\r\n      if (this.client_type === 'wechat' || this.client_type === 'alipay') {\r\n        if (getStorage('state') === getUrlParam('state') && getStorage('state') && getUrlParam('state')) {\r\n          this.decryptData();\r\n        } else {\r\n          let _this = this;\r\n          removeStorage('token');\r\n          removeStorage('state');\r\n\r\n          Dialog.alert({\r\n            title: '绑定失败',\r\n            message: '您的账号信息绑定失败,请重新授权绑定。',\r\n          }).then(() => {\r\n            if (this.redirect_uri && getStorage('check_iccid')) {\r\n              _this.$router.push(this.redirect_uri);\r\n            } else {\r\n              if (localStorage.getItem(\"currentType\") === \"userCenter\") {\r\n                this.$router.push('/weixin/userCenter/index');\r\n              } else if (localStorage.getItem(\"currentType\") === \"esim\") {\r\n                this.$router.push('/weixin/card/esim_usage');\r\n              } else {\r\n                _this.$router.push('/weixin/card/lookup');\r\n              }\r\n            }\r\n          })\r\n        }\r\n      } else {\r\n        this.$router.push('/weixin/card/lookup')\r\n      }\r\n    },\r\n\r\n    methods: {\r\n      decryptData() {\r\n        _post('/accountCenter/v2/secret/decrypt?' + codeParam({}, 'post'), {\r\n          data: getUrlParam('data')\r\n        }).then(res => {\r\n          if (res.error === 0) {\r\n            if (this.client_type === 'alipay') {\r\n              let aliUser = {\r\n                uuid: res.data.data.user_id,\r\n                openid: res.data.data.user_id,\r\n                headimgurl: res.data.data.avatar,\r\n                gender: res.data.data.gender === 'm' ? 1 : 2,\r\n                nickname: res.data.data.nick_name\r\n              };\r\n              setStorage('decrypt_data', aliUser, 'obj');\r\n            } else if (this.client_type === 'wechat') {\r\n              let wechatUserData = res.data.data;\r\n              if (wechatUserData.unionid) {\r\n                wechatUserData.openid = wechatUserData.unionid\r\n              }\r\n              setStorage('decrypt_data', wechatUserData, 'obj');\r\n            }\r\n            //login\r\n            this.login(res);\r\n\r\n          } else if (res.error === 11002) {\r\n            this.$emit('getToken')\r\n          } else {\r\n            this.showAuthorityError('B' + res.error)\r\n          }\r\n        })\r\n      }, // 解密data\r\n      login(res) {\r\n        _post('/accountCenter/v2/auth/login?' + codeParam({}, 'post'), {\r\n          uuid: getStorage('decrypt_data', 'obj').openid,\r\n          code: res.data.code\r\n        }).then(res => {\r\n          if (res.error === 0) {\r\n            setStorage('token', res.data, 'str', true);//获取token\r\n            if (this.redirect_uri && getStorage('check_iccid')) {\r\n              this.$router.push(this.redirect_uri);\r\n            } else {\r\n              if (localStorage.getItem(\"currentType\") === \"userCenter\") {\r\n                this.$router.push('/weixin/userCenter/index');\r\n              } else if (localStorage.getItem(\"currentType\") === \"esim\") {\r\n                this.$router.push('/weixin/card/esim_usage');\r\n              } else if (this.redirect_uri==\"/weixin/userCenter/index\")\r\n                this.$router.push(this.redirect_uri);\r\n              else {\r\n                this.$router.push('/weixin/card/lookup');\r\n              }\r\n            }\r\n          } else if (res.error === 11002) {\r\n            this.$emit('getToken')\r\n          } else if (res.error === 30005 || res.error === 11003) {\r\n            let _this = this;\r\n            // Dialog.alert({\r\n            //   title: '绑定信息',\r\n            //   message: '为了您的账号安全，需要绑定您的手机号码',\r\n            // }).then(() => {\r\n              _this.$router.push({path: '/login'})\r\n            // })\r\n          } else {\r\n            this.showAuthorityError('L' + res.error)\r\n          }\r\n        })\r\n      }, // 登录\r\n\r\n      showAuthorityError(flag) {\r\n        let _this = this;\r\n        let _flag = flag ? flag : '';\r\n        Dialog.alert({\r\n          title: '账号异常',\r\n          message: '您的账户信息存在问题,无法进行操作,请联系我司客服工作人员,我们将尽快为您解决问题' + _flag + '。',\r\n        }).then(() => {\r\n          _this.load_user_msg = true;\r\n          _this.load_user_info = '账号异常' + _flag;\r\n\r\n        })\r\n      },// 拦截错误信息\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\">\r\n  body, html {\r\n    height: 100%;\r\n  }\r\n\r\n  .authority-middle-wrap {\r\n    display: flex;\r\n    height: 100%;\r\n    align-items: center;\r\n    justify-content: center;\r\n    /*background: #00b6f3;*/\r\n    /*background: #8c8c8c;*/\r\n\r\n    [class*=\"loader-\"] {\r\n      display: inline-block;\r\n      width: 1em;\r\n      height: 1em;\r\n      color: inherit;\r\n      vertical-align: middle;\r\n      pointer-events: none;\r\n    }\r\n\r\n    .box {\r\n      display: inline-block;\r\n      font-size: 40px;\r\n      color: #fff;\r\n      transition: .3s color, .3s border;\r\n    }\r\n\r\n    .loader-14 {\r\n      border-radius: 50%;\r\n      box-shadow: 0 1em 0 -.2em currentcolor;\r\n      position: relative;\r\n      -webkit-animation: loader-14 0.8s ease-in-out alternate infinite;\r\n      animation: loader-14 0.8s ease-in-out alternate infinite;\r\n      -webkit-animation-delay: 0.32s;\r\n      animation-delay: 0.32s;\r\n      top: -1em;\r\n    }\r\n\r\n    .loader-14:after,\r\n    .loader-14:before {\r\n      content: '';\r\n      position: absolute;\r\n      width: inherit;\r\n      height: inherit;\r\n      border-radius: inherit;\r\n      box-shadow: inherit;\r\n      -webkit-animation: inherit;\r\n      animation: inherit;\r\n    }\r\n\r\n    .loader-14:before {\r\n      left: -1em;\r\n      -webkit-animation-delay: 0.48s;\r\n      animation-delay: 0.48s;\r\n    }\r\n\r\n    .loader-14:after {\r\n      right: -1em;\r\n      -webkit-animation-delay: 0.16s;\r\n      animation-delay: 0.16s;\r\n    }\r\n\r\n    @-webkit-keyframes loader-14 {\r\n      0% {\r\n        box-shadow: 0 2em 0 -.2em currentcolor;\r\n      }\r\n      100% {\r\n        box-shadow: 0 1em 0 -.2em currentcolor;\r\n      }\r\n    }\r\n    @keyframes loader-14 {\r\n      0% {\r\n        box-shadow: 0 2em 0 -.2em currentcolor;\r\n      }\r\n      100% {\r\n        box-shadow: 0 1em 0 -.2em currentcolor;\r\n      }\r\n    }\r\n\r\n  }\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=0248a219&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"index.vue\"\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}